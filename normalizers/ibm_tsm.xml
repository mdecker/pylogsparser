<?xml version="1.0" encoding="UTF-8"?>
<!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
<!--                                                            -->
<!-- pylogparser - Logs parsers python library                  -->
<!-- Copyright (C) 2011 Wallix Inc.                             -->
<!--                                                            -->
<!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
<!--                                                            -->
<!-- This package is free software; you can redistribute        -->
<!-- it and/or modify it under the terms of the GNU Lesser      -->
<!-- General Public License as published by the Free Software   -->
<!-- Foundation; either version 2.1 of the License, or (at      -->
<!-- your option) any later version.                            -->
<!--                                                            -->
<!-- This package is distributed in the hope that it will be    -->
<!-- useful, but WITHOUT ANY WARRANTY; without even the implied -->
<!-- warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR    -->
<!-- PURPOSE.  See the GNU Lesser General Public License for    -->
<!-- more details.                                              -->
<!--                                                            -->
<!-- You should have received a copy of the GNU Lesser General  -->
<!-- Public License along with this package; if not, write      -->
<!-- to the Free Software Foundation, Inc., 59 Temple Place,    -->
<!-- Suite 330, Boston, MA  02111-1307  USA                     -->
<!--                                                            -->
<!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
<!DOCTYPE normalizer SYSTEM "normalizer.dtd">
<normalizer name="tsm"
            version="0.99"
            unicode="yes"
            ignorecase="yes"
            matchtype="match"
            appliedTo="raw"
            taxonomy="backup">
    <description>
        <localized_desc language="en">parser for dsmsched.log files generated by IBM TSM Client</localized_desc>
    </description>
    <authors>
        <author>mde.proj@gmail.com</author>
    </authors>
    <tagTypes>
        <tagType name="TSM_DATETIME" type="basestring">
            <description>
                <localized_desc language="en">datetime stamp</localized_desc>
            </description>
            <regexp>\d{2}\.\d{2}\.\d{4} \d{2}:\d{2}:\d{2}</regexp>
        </tagType>
        <tagType name="TSM_NODENAME" type="basestring">
            <description>
                <localized_desc language="en">a nodename</localized_desc>
            </description>
            <regexp>\w+</regexp>
        </tagType>
        <tagType name="TSM_INTNUMBER" type="basestring">
            <description>
                <localized_desc language="en">a simple integer number without grouping</localized_desc>
            </description>
            <regexp>\d+</regexp>
        </tagType>
        <tagType name="TSM_INTNUMBER_FORMATTED" type="basestring">
            <description>
                <localized_desc language="en">an int number with possible digit grouping. ATTENTION: group separator depends on TSM client locale!</localized_desc>
            </description>
            <regexp>\d+((,|\.)\d+)*</regexp>
        </tagType>
        <tagType name="TSM_SCHEDULENAME" type="basestring">
            <description>
                <localized_desc language="en">a schedule name</localized_desc>
            </description>
            <regexp>\w+</regexp>
        </tagType>
        <tagType name="TSM_SERVERNAME" type="basestring">
            <description>
                <localized_desc language="en">a servername (not FQDN)</localized_desc>
            </description>
            <regexp>\w+</regexp>
        </tagType>
        <tagType name="TSM_OSNAME" type="basestring">
            <description>
                <localized_desc language="en">OS name</localized_desc>
            </description>
            <regexp>\w+</regexp>
        </tagType>
        <tagType name="TSM_VERSIONNUMBER" type="basestring">
            <description>
                <localized_desc language="en">a version number</localized_desc>
            </description>
            <regexp>\d+(\.\d+)?</regexp>
        </tagType>
        <tagType name="TSM_ITEMTYPE" type="basestring">
            <description>
                <localized_desc language="en">type of backed up item</localized_desc>
            </description>
            <regexp>(Directory|Normal File)</regexp>
        </tagType>
        <tagType name="TSM_VOLUMENAME" type="basestring">
            <description>
                <localized_desc language="en">name of backed up volume</localized_desc>
            </description>
            <regexp>\S+</regexp>
        </tagType>
        <tagType name="TSM_ITEMPATH" type="basestring">
            <description>
                <localized_desc language="en">path to processed item</localized_desc>
            </description>
            <regexp>[^\[]+(?!\[)</regexp>
        </tagType>
        <tagType name="TSM_ITEMSTATUS" type="basestring">
            <description>
                <localized_desc language="en">status of processed item</localized_desc>
            </description>
            <regexp>\S+</regexp>
        </tagType>
        <tagType name="TSM_BACKUPTYPE" type="basestring">
            <description>
                <localized_desc language="en">type of backup being performed, for example "incremental"</localized_desc>
            </description>
            <regexp>\w+</regexp>
        </tagType>
        <tagType name="TSM_OBJECTCATEGORY" type="basestring">
            <description>
                <localized_desc language="en">category of object processed</localized_desc>
            </description>
            <regexp>(inspected|backed up|updated|rebound|deleted|expired|failed)</regexp>
        </tagType>
        <tagType name="TSM_BYTECATEGORY" type="basestring">
            <description>
                <localized_desc language="en">category of bytes processed</localized_desc>
            </description>
            <regexp>(inspected|transferred)</regexp>
        </tagType>
        <tagType name="TSM_TWODIGITPRECISION_POSTFIXED" type="basestring">
            <description>
                <localized_desc language="en">any number with two decimal places and postfixed units. ATTENTION: decimal separator depends on TSM client locale!</localized_desc>
            </description>
            <regexp>\d+(,|\.)\d{2} \w+</regexp>
        </tagType>
        <tagType name="TSM_TRANSFERRATE_POSTFIXED" type="basestring">
            <description>
                <localized_desc language="en">network transfer rate with two decimal places and postfixed units. ATTENTION: decimal separator and grouping depends on TSM client locale!</localized_desc>
            </description>
            <regexp>\d[0-9,.]*(,|\.)\d{2} \w+/\w+</regexp>
        </tagType>
        <tagType name="TSM_TRANSFERCATEGORY" type="basestring">
            <description>
                <localized_desc language="en">category of transfer rate</localized_desc>
            </description>
            <regexp>(Network|Aggregate)</regexp>
        </tagType>
        <tagType name="TSM_RATIO_PERCENT" type="basestring">
            <description>
                <localized_desc language="en">ratio expressed in percent with up to two decimal places</localized_desc>
            </description>
            <regexp>\d+((,|\.)\d{1,2})?%</regexp>
        </tagType>
        <tagType name="TSM_ELAPSED_TIME" type="basestring">
            <description>
                <localized_desc language="en">elapsed time in H:M:S format with potentially unlimited hours</localized_desc>
            </description>
            <regexp>\d{2,}:\d{2}:\d{2}</regexp>
        </tagType>
        <tagType name="TSM_SUMMARYMARKER" type="basestring">
            <description>
                <localized_desc language="en">marks beginning or end of backup summary</localized_desc>
            </description>
            <regexp>(BEGIN|END)</regexp>
        </tagType>
    </tagTypes>
    <callbacks>
        <callback name="dd.MM.YYYY hh:mm:ss">
r = re.compile('(?P&lt;day&gt;\d{2})\.(?P&lt;month&gt;\d{2})\.(?P&lt;year&gt;\d{4}) (?P&lt;hour&gt;\d{2}):(?P&lt;minute&gt;\d{2}):(?P&lt;second&gt;\d{2})')
date = r.search(value).groupdict()
date = dict([(u, int(date[u])) for u in date.keys()])
newdate = datetime(**date)
log['date'] = newdate
        </callback>
        <callback name="minutes">
log['minutes'] = int(value)
        </callback>
    </callbacks>
    <patterns>
        <pattern name="tsm-999">
            <description>
                <localized_desc language="en">single dateline, followed by a "Executing scheduled command now."-Line (not checked here)</localized_desc>
            </description>
            <text>__DATE__$</text>
            <tags>
                <tag name="__date" tagType="TSM_DATETIME">
                    <description>
                        <localized_desc language="en">event date</localized_desc>
                    </description>
                    <substitute>__DATE__</substitute>
                    <callbacks>
                        <callback>dd.MM.YYYY hh:mm:ss</callback>
                    </callbacks>
                </tag>
            </tags>
            <examples>
                <example>
                     <text>31.03.2017 10:16:54</text>
                     <expectedTags>
                          <expectedTag name="date">2017-03-31 10:16:54</expectedTag>
                     </expectedTags>
                </example>
            </examples>
        </pattern>
        <pattern name="tsm-998">
            <description>
                <localized_desc language="en">"Executing scheduled command now."</localized_desc>
            </description>
            <text>Executing scheduled command now__REST__</text>
            <tags>
                <tag name="rest" tagType="anything">
                    <description>
                        <localized_desc language="en">only there to provide anythin to match at all</localized_desc>
                    </description>
                    <substitute>__REST__</substitute>
                </tag>
            </tags>
            <examples>
                <example>
                     <text>Executing scheduled command now.</text>
                     <expectedTags>
                          <expectedTag name="rest">.</expectedTag>
                     </expectedTags>
                </example>
            </examples>
        </pattern>
        <pattern name="tsm-001">
            <description>
                <localized_desc language="en">Node Name</localized_desc>
            </description>
            <text>__DATE__ Node Name: __NODENAME__</text>
            <tags>
                <tag name="__date" tagType="TSM_DATETIME">
                    <description>
                        <localized_desc language="en">event date</localized_desc>
                    </description>
                    <substitute>__DATE__</substitute>
                    <callbacks>
                        <callback>dd.MM.YYYY hh:mm:ss</callback>
                    </callbacks>
                </tag>
                <tag name="nodename" tagType="TSM_NODENAME">
                    <description>
                        <localized_desc language="en">local nodename</localized_desc>
                    </description>
                    <substitute>__NODENAME__</substitute>
                </tag>
            </tags>
            <examples>
                <example>
                     <text>31.03.2017 10:16:57 Node Name: HOST123</text>
                     <expectedTags>
                          <expectedTag name="date">2017-03-31 10:16:57</expectedTag>
                          <expectedTag name="nodename">HOST123</expectedTag>
                     </expectedTags>
                </example>
            </examples>
        </pattern>
        <pattern name="tsm-002">
            <description>
                <localized_desc language="en">command retry status</localized_desc>
            </description>
            <text>__DATE__ Command will be retried in __MINS__ minutes.</text>
            <tags>
                <tag name="__date" tagType="TSM_DATETIME">
                    <description>
                        <localized_desc language="en">event date</localized_desc>
                    </description>
                    <substitute>__DATE__</substitute>
                    <callbacks>
                        <callback>dd.MM.YYYY hh:mm:ss</callback>
                    </callbacks>
                </tag>
                <tag name="minutes" tagType="TSM_INTNUMBER_FORMATTED">
                    <description>
                        <localized_desc language="en">minutes value</localized_desc>
                    </description>
                    <substitute>__MINS__</substitute>
                    <!--callbacks>
                        <callback>minutes</callback>
                    </callbacks -->
                </tag>
            </tags>
            <examples>
                <example>
                     <text>31.03.2017 10:16:57 Command will be retried in 20 minutes.</text>
                     <expectedTags>
                          <expectedTag name="date">2017-03-31 10:16:57</expectedTag>
                          <expectedTag name="minutes">20</expectedTag>
                     </expectedTags>
                </example>
            </examples>
        </pattern>
        <pattern name="tsm-003">
            <description>
                <localized_desc language="en">retry scheduled event name</localized_desc>
            </description>
            <text>__DATE__ Retrying scheduled event: __SCHEDNAME__</text>
            <tags>
                <tag name="__date" tagType="TSM_DATETIME">
                    <description>
                        <localized_desc language="en">event date</localized_desc>
                    </description>
                    <substitute>__DATE__</substitute>
                    <callbacks>
                        <callback>dd.MM.YYYY hh:mm:ss</callback>
                    </callbacks>
                </tag>
                <tag name="schedule" tagType="TSM_SCHEDULENAME">
                    <description>
                        <localized_desc language="en">name of backup schedule</localized_desc>
                    </description>
                    <substitute>__SCHEDNAME__</substitute>
                </tag>
            </tags>
            <examples>
                <example>
                     <text>31.03.2017 10:36:57 Retrying scheduled event: DESKTOP_1000_DAILY</text>
                     <expectedTags>
                          <expectedTag name="date">2017-03-31 10:36:57</expectedTag>
                          <expectedTag name="schedule">DESKTOP_1000_DAILY</expectedTag>
                     </expectedTags>
                </example>
            </examples>
        </pattern>
        <pattern name="tsm-004">
            <description>
                <localized_desc language="en">session established</localized_desc>
            </description>
            <text>__DATE__ Session established with server __SERVERNAME__: __SERVEROS__</text>
            <tags>
                <tag name="__date" tagType="TSM_DATETIME">
                    <description>
                        <localized_desc language="en">event date</localized_desc>
                    </description>
                    <substitute>__DATE__</substitute>
                    <callbacks>
                        <callback>dd.MM.YYYY hh:mm:ss</callback>
                    </callbacks>
                </tag>
                <tag name="servername" tagType="TSM_SERVERNAME">
                    <description>
                        <localized_desc language="en">name of backup server</localized_desc>
                    </description>
                    <substitute>__SERVERNAME__</substitute>
                </tag>
                <tag name="serveros" tagType="TSM_OSNAME">
                    <description>
                        <localized_desc language="en">OS of backup server</localized_desc>
                    </description>
                    <substitute>__SERVEROS__</substitute>
                </tag>
            </tags>
            <examples>
                <example>
                     <text>31.03.2017 10:36:58 Session established with server TSM1C: AIX</text>
                     <expectedTags>
                          <expectedTag name="date">2017-03-31 10:36:58</expectedTag>
                          <expectedTag name="servername">TSM1C</expectedTag>
                          <expectedTag name="serveros">AIX</expectedTag>
                     </expectedTags>
                </example>
            </examples>
        </pattern>
        <pattern name="tsm-005">
            <description>
                <localized_desc language="en">session established: server version</localized_desc>
            </description>
            <text>__DATE__ \s*Server Version __MAJORVERSION__, Release __RELEASEVERSION__, Level __LEVELVERSION__</text>
            <tags>
                <tag name="__date" tagType="TSM_DATETIME">
                    <description>
                        <localized_desc language="en">event date</localized_desc>
                    </description>
                    <substitute>__DATE__</substitute>
                    <callbacks>
                        <callback>dd.MM.YYYY hh:mm:ss</callback>
                    </callbacks>
                </tag>
                <tag name="majorversion" tagType="TSM_VERSIONNUMBER">
                    <description>
                        <localized_desc language="en">major version backup server</localized_desc>
                    </description>
                    <substitute>__MAJORVERSION__</substitute>
                </tag>
                <tag name="releaseversion" tagType="TSM_VERSIONNUMBER">
                    <description>
                        <localized_desc language="en">release version backup server</localized_desc>
                    </description>
                    <substitute>__RELEASEVERSION__</substitute>
                </tag>
                <tag name="levelversion" tagType="TSM_VERSIONNUMBER">
                    <description>
                        <localized_desc language="en">release level version backup server</localized_desc>
                    </description>
                    <substitute>__LEVELVERSION__</substitute>
                </tag>
            </tags>
            <examples>
                <example>
                     <text>31.03.2017 10:36:58   Server Version 6, Release 3, Level 4.300</text>
                     <expectedTags>
                          <expectedTag name="date">2017-03-31 10:36:58</expectedTag>
                          <expectedTag name="majorversion">6</expectedTag>
                          <expectedTag name="releaseversion">3</expectedTag>
                          <expectedTag name="levelversion">4.300</expectedTag>
                     </expectedTags>
                </example>
            </examples>
        </pattern>
        <pattern name="tsm-006">
            <description>
                <localized_desc language="en">session established: server time and last node access</localized_desc>
            </description>
            <text>__DATE__ \s*Server date/time: __SERVERSTAMP__  Last access: __LASTACCESSSTAMP__</text>
            <tags>
                <tag name="__date" tagType="TSM_DATETIME">
                    <description>
                        <localized_desc language="en">event date</localized_desc>
                    </description>
                    <substitute>__DATE__</substitute>
                    <callbacks>
                        <callback>dd.MM.YYYY hh:mm:ss</callback>
                    </callbacks>
                </tag>
                <tag name="serverdate" tagType="TSM_DATETIME">
                    <description>
                        <localized_desc language="en">server timestamp</localized_desc>
                    </description>
                    <substitute>__SERVERSTAMP__</substitute>
                </tag>
                <tag name="lastaccessdate" tagType="TSM_DATETIME">
                    <description>
                        <localized_desc language="en">last access timestamp</localized_desc>
                    </description>
                    <substitute>__LASTACCESSSTAMP__</substitute>
                </tag>
            </tags>
            <examples>
                <example>
                     <text>31.03.2017 10:36:58   Server date/time: 31.03.2017 10:36:58  Last access: 30.03.2017 22:42:55</text>
                     <expectedTags>
                          <expectedTag name="date">2017-03-31 10:36:58</expectedTag>
                          <expectedTag name="serverdate">31.03.2017 10:36:58</expectedTag>
                          <expectedTag name="lastaccessdate">30.03.2017 22:42:55</expectedTag>
                     </expectedTags>
                </example>
            </examples>
        </pattern>
        <pattern name="tsm-007">
            <description>
                <localized_desc language="en">begin or end ofbackup</localized_desc>
            </description>
            <text>__DATE__ --- SCHEDULEREC OBJECT __TYPE__ __SCHEDNAME__ __SCHEDULESTARTTIME__</text>
            <tags>
                <tag name="__date" tagType="TSM_DATETIME">
                    <description>
                        <localized_desc language="en">event date</localized_desc>
                    </description>
                    <substitute>__DATE__</substitute>
                    <callbacks>
                        <callback>dd.MM.YYYY hh:mm:ss</callback>
                    </callbacks>
                </tag>
                <tag name="type" tagType="TSM_SUMMARYMARKER">
                    <description>
                        <localized_desc language="en">beginning or end of run</localized_desc>
                    </description>
                    <substitute>__TYPE__</substitute>
                </tag>
                <tag name="schedule" tagType="TSM_SCHEDULENAME">
                    <description>
                        <localized_desc language="en">name of backup schedule</localized_desc>
                    </description>
                    <substitute>__SCHEDNAME__</substitute>
                </tag>
                <tag name="schedulestarttime" tagType="TSM_DATETIME">
                    <description>
                        <localized_desc language="en">official start time of schedule</localized_desc>
                    </description>
                    <substitute>__SCHEDULESTARTTIME__</substitute>
                </tag>
            </tags>
            <examples>
                <example>
                     <text>31.03.2017 10:36:58 --- SCHEDULEREC OBJECT BEGIN DESKTOP_1000_DAILY 31.03.2017 10:00:00</text>
                     <expectedTags>
                          <expectedTag name="date">2017-03-31 10:36:58</expectedTag>
                          <expectedTag name="type">BEGIN</expectedTag>
                          <expectedTag name="schedule">DESKTOP_1000_DAILY</expectedTag>
                          <expectedTag name="schedulestarttime">31.03.2017 10:00:00</expectedTag>
                     </expectedTags>
                </example>
                <example>
                     <text>31.03.2017 10:53:00 --- SCHEDULEREC OBJECT END DESKTOP_1000_DAILY 31.03.2017 10:00:00</text>
                     <expectedTags>
                          <expectedTag name="date">2017-03-31 10:53:00</expectedTag>
                          <expectedTag name="type">END</expectedTag>
                          <expectedTag name="schedule">DESKTOP_1000_DAILY</expectedTag>
                          <expectedTag name="schedulestarttime">31.03.2017 10:00:00</expectedTag>
                     </expectedTags>
                </example>
            </examples>
        </pattern>
        <pattern name="tsm-008">
            <description>
                <localized_desc language="en">begin incremental backup volume</localized_desc>
            </description>
            <text>__DATE__ Incremental backup of volume __VOLUMENAME__</text>
            <tags>
                <tag name="__date" tagType="TSM_DATETIME">
                    <description>
                        <localized_desc language="en">event date</localized_desc>
                    </description>
                    <substitute>__DATE__</substitute>
                    <callbacks>
                        <callback>dd.MM.YYYY hh:mm:ss</callback>
                    </callbacks>
                </tag>
                <tag name="volume" tagType="TSM_VOLUMENAME">
                    <description>
                        <localized_desc language="en">name of volume being backed up</localized_desc>
                    </description>
                    <substitute>__VOLUMENAME__</substitute>
                </tag>
            </tags>
            <examples>
                <example>
                     <text>31.03.2017 10:36:58 Incremental backup of volume '\\host123\c$'</text>
                     <expectedTags>
                          <expectedTag name="date">2017-03-31 10:36:58</expectedTag>
                          <expectedTag name="volume">'\\host123\c$'</expectedTag>
                     </expectedTags>
                </example>
            </examples>
        </pattern>
        <pattern name="tsm-009">
            <description>
                <localized_desc language="en">processed files status message</localized_desc>
            </description>
            <text>__DATE__ ANS1898I \*+ Processed\s+__NUMFILES__ files \*+</text>
            <tags>
                <tag name="__date" tagType="TSM_DATETIME">
                    <description>
                        <localized_desc language="en">event date</localized_desc>
                    </description>
                    <substitute>__DATE__</substitute>
                    <callbacks>
                        <callback>dd.MM.YYYY hh:mm:ss</callback>
                    </callbacks>
                </tag>
                <tag name="numfiles" tagType="TSM_INTNUMBER_FORMATTED">
                    <description>
                        <localized_desc language="en">number of files backed up so far (progress)</localized_desc>
                    </description>
                    <substitute>__NUMFILES__</substitute>
                </tag>
            </tags>
            <examples>
                <example>
                     <text>31.03.2017 10:39:51 ANS1898I ***** Processed       500 files *****</text>
                     <expectedTags>
                          <expectedTag name="date">2017-03-31 10:39:51</expectedTag>
                          <expectedTag name="numfiles">500</expectedTag>
                     </expectedTags>
                </example>
                <example>
                     <text>31.03.2017 10:52:49 ANS1898I ***** Processed 1.173.000 files *****</text>
                     <expectedTags>
                          <expectedTag name="date">2017-03-31 10:52:49</expectedTag>
                          <expectedTag name="numfiles">1.173.000</expectedTag>
                     </expectedTags>
                </example>
            </examples>
        </pattern>
        <pattern name="tsm-010">
            <description>
                <localized_desc language="en">backed up item (file/directory)</localized_desc>
            </description>
            <text>__DATE__ __ITEMTYPE__-->\s+__ITEMSIZE__ __ITEMPATH__ \[__ITEMSTATUS__\]</text>
            <tags>
                <tag name="__date" tagType="TSM_DATETIME">
                    <description>
                        <localized_desc language="en">event date</localized_desc>
                    </description>
                    <substitute>__DATE__</substitute>
                    <callbacks>
                        <callback>dd.MM.YYYY hh:mm:ss</callback>
                    </callbacks>
                </tag>
                <tag name="itemtype" tagType="TSM_ITEMTYPE">
                    <description>
                        <localized_desc language="en">type of item being processed (file, directory,...)</localized_desc>
                    </description>
                    <substitute>__ITEMTYPE__</substitute>
                </tag>
                <tag name="itemsize" tagType="TSM_INTNUMBER_FORMATTED">
                    <description>
                        <localized_desc language="en">size of processed item</localized_desc>
                    </description>
                    <substitute>__ITEMSIZE__</substitute>
                </tag>
                <tag name="itempath" tagType="TSM_ITEMPATH">
                    <description>
                        <localized_desc language="en">path of processed item</localized_desc>
                    </description>
                    <substitute>__ITEMPATH__</substitute>
                </tag>
                <tag name="itemstatus" tagType="TSM_ITEMSTATUS">
                    <description>
                        <localized_desc language="en">status of processed item (sent, expired, ...)</localized_desc>
                    </description>
                    <substitute>__ITEMSTATUS__</substitute>
                </tag>
            </tags>
            <examples>
                <example>
                     <text>31.03.2017 10:52:49 Directory-->                   0 \\host123\c$\opsi.org\log [Sent]</text>
                     <expectedTags>
                          <expectedTag name="date">2017-03-31 10:52:49</expectedTag>
                          <expectedTag name="itemtype">Directory</expectedTag>
                          <expectedTag name="itemsize">0</expectedTag>
                          <expectedTag name="itempath">\\host123\c$\opsi.org\log</expectedTag>
                          <expectedTag name="itemstatus">Sent</expectedTag>
                     </expectedTags>
                </example>
                <example>
                     <text>31.03.2017 10:52:50 Normal File-->            33.709 \\host123\c$\opsi.org\log\opsi_loginblocker.log.3 [Sent]</text>
                     <expectedTags>
                          <expectedTag name="date">2017-03-31 10:52:50</expectedTag>
                          <expectedTag name="itemtype">Normal File</expectedTag>
                          <expectedTag name="itemsize">33.709</expectedTag>
                          <expectedTag name="itempath">\\host123\c$\opsi.org\log\opsi_loginblocker.log.3</expectedTag>
                          <expectedTag name="itemstatus">Sent</expectedTag>
                     </expectedTags>
                </example>
                <example>
                     <text>31.03.2017 10:52:50 Normal File-->               491 \\host123\c$\Program Files\Tivoli\TSM\baclient\tsmstats.ini [Sent]</text>
                     <expectedTags>
                          <expectedTag name="date">2017-03-31 10:52:50</expectedTag>
                          <expectedTag name="itemtype">Normal File</expectedTag>
                          <expectedTag name="itemsize">491</expectedTag>
                          <expectedTag name="itempath">\\host123\c$\Program Files\Tivoli\TSM\baclient\tsmstats.ini</expectedTag>
                          <expectedTag name="itemstatus">Sent</expectedTag>
                     </expectedTags>
                </example>
            </examples>
        </pattern>
        <pattern name="tsm-011">
            <description>
                <localized_desc language="en">successful backup of volume</localized_desc>
            </description>
            <text>__DATE__ Successful __BACKUPTYPE__ backup of __VOLUMENAME__</text>
            <tags>
                <tag name="__date" tagType="TSM_DATETIME">
                    <description>
                        <localized_desc language="en">event date</localized_desc>
                    </description>
                    <substitute>__DATE__</substitute>
                    <callbacks>
                        <callback>dd.MM.YYYY hh:mm:ss</callback>
                    </callbacks>
                </tag>
                <tag name="backuptype" tagType="TSM_BACKUPTYPE">
                    <description>
                        <localized_desc language="en">type of backup being performed (incremental,...)</localized_desc>
                    </description>
                    <substitute>__BACKUPTYPE__</substitute>
                </tag>
                <tag name="volume" tagType="TSM_VOLUMENAME">
                    <description>
                        <localized_desc language="en">name of volume being backed up</localized_desc>
                    </description>
                    <substitute>__VOLUMENAME__</substitute>
                </tag>
            </tags>
            <examples>
                <example>
                     <text>31.03.2017 10:52:59 Successful incremental backup of '\\host123\c$'</text>
                     <expectedTags>
                          <expectedTag name="date">2017-03-31 10:52:59</expectedTag>
                          <expectedTag name="backuptype">incremental</expectedTag>
                          <expectedTag name="volume">'\\host123\c$'</expectedTag>
                     </expectedTags>
                </example>
            </examples>
        </pattern>
        <pattern name="tsm-012">
            <description>
                <localized_desc language="en">begin or end of backup summary</localized_desc>
            </description>
            <text>__DATE__ --- SCHEDULEREC STATUS __TYPE__</text>
            <tags>
                <tag name="__date" tagType="TSM_DATETIME">
                    <description>
                        <localized_desc language="en">event date</localized_desc>
                    </description>
                    <substitute>__DATE__</substitute>
                    <callbacks>
                        <callback>dd.MM.YYYY hh:mm:ss</callback>
                    </callbacks>
                </tag>
                <tag name="type" tagType="TSM_SUMMARYMARKER">
                    <description>
                        <localized_desc language="en">beginning or end of summary</localized_desc>
                    </description>
                    <substitute>__TYPE__</substitute>
                </tag>
            </tags>
            <examples>
                <example>
                     <text>31.03.2017 10:53:00 --- SCHEDULEREC STATUS BEGIN</text>
                     <expectedTags>
                          <expectedTag name="date">2017-03-31 10:53:00</expectedTag>
                          <expectedTag name="type">BEGIN</expectedTag>
                     </expectedTags>
                </example>
                <example>
                     <text>31.03.2017 10:53:00 --- SCHEDULEREC STATUS END</text>
                     <expectedTags>
                          <expectedTag name="date">2017-03-31 10:53:00</expectedTag>
                          <expectedTag name="type">END</expectedTag>
                     </expectedTags>
                </example>
            </examples>
        </pattern>
        <pattern name="tsm-013">
            <description>
                <localized_desc language="en">summary: number of objects processed in a specific way</localized_desc>
            </description>
            <text>__DATE__ Total number of objects __OBJECTCATEGORY__:\s+__NUMOBJECTS__</text>
            <tags>
                <tag name="__date" tagType="TSM_DATETIME">
                    <description>
                        <localized_desc language="en">event date</localized_desc>
                    </description>
                    <substitute>__DATE__</substitute>
                    <callbacks>
                        <callback>dd.MM.YYYY hh:mm:ss</callback>
                    </callbacks>
                </tag>
                <tag name="objectcategory" tagType="TSM_OBJECTCATEGORY">
                    <description>
                        <localized_desc language="en">summary applies to objects of this category</localized_desc>
                    </description>
                    <substitute>__OBJECTCATEGORY__</substitute>
                </tag>
                <tag name="numobjects" tagType="TSM_INTNUMBER_FORMATTED">
                    <description>
                        <localized_desc language="en">number of files processed</localized_desc>
                    </description>
                    <substitute>__NUMOBJECTS__</substitute>
                </tag>
            </tags>
            <examples>
                <example>
                     <text>31.03.2017 10:53:00 Total number of objects inspected:    1.173.009</text>
                     <expectedTags>
                          <expectedTag name="date">2017-03-31 10:53:00</expectedTag>
                          <expectedTag name="objectcategory">inspected</expectedTag>
                          <expectedTag name="numobjects">1.173.009</expectedTag>
                     </expectedTags>
                </example>
                <example>
                     <text>31.03.2017 10:53:00 Total number of objects backed up:          290</text>
                     <expectedTags>
                          <expectedTag name="date">2017-03-31 10:53:00</expectedTag>
                          <expectedTag name="objectcategory">backed up</expectedTag>
                          <expectedTag name="numobjects">290</expectedTag>
                     </expectedTags>
                </example>
                <example>
                     <text>31.03.2017 10:53:00 Total number of objects updated:              0</text>
                     <expectedTags>
                          <expectedTag name="date">2017-03-31 10:53:00</expectedTag>
                          <expectedTag name="objectcategory">updated</expectedTag>
                          <expectedTag name="numobjects">0</expectedTag>
                     </expectedTags>
                </example>
                <example>
                     <text>31.03.2017 10:53:00 Total number of objects rebound:              0</text>
                     <expectedTags>
                          <expectedTag name="date">2017-03-31 10:53:00</expectedTag>
                          <expectedTag name="objectcategory">rebound</expectedTag>
                          <expectedTag name="numobjects">0</expectedTag>
                     </expectedTags>
                </example>
                <example>
                     <text>31.03.2017 10:53:00 Total number of objects deleted:              0</text>
                     <expectedTags>
                          <expectedTag name="date">2017-03-31 10:53:00</expectedTag>
                          <expectedTag name="objectcategory">deleted</expectedTag>
                          <expectedTag name="numobjects">0</expectedTag>
                     </expectedTags>
                </example>
                <example>
                     <text>31.03.2017 10:53:00 Total number of objects expired:              0</text>
                     <expectedTags>
                          <expectedTag name="date">2017-03-31 10:53:00</expectedTag>
                          <expectedTag name="objectcategory">expired</expectedTag>
                          <expectedTag name="numobjects">0</expectedTag>
                     </expectedTags>
                </example>
                <example>
                     <text>31.03.2017 10:53:00 Total number of objects failed:               0</text>
                     <expectedTags>
                          <expectedTag name="date">2017-03-31 10:53:00</expectedTag>
                          <expectedTag name="objectcategory">failed</expectedTag>
                          <expectedTag name="numobjects">0</expectedTag>
                     </expectedTags>
                </example>
            </examples>
        </pattern>
        <pattern name="tsm-014">
            <description>
                <localized_desc language="en">summary: number of subfile objects processed</localized_desc>
            </description>
            <text>__DATE__ Total number of subfile objects:\s+__NUMOBJECTS__</text>
            <tags>
                <tag name="__date" tagType="TSM_DATETIME">
                    <description>
                        <localized_desc language="en">event date</localized_desc>
                    </description>
                    <substitute>__DATE__</substitute>
                    <callbacks>
                        <callback>dd.MM.YYYY hh:mm:ss</callback>
                    </callbacks>
                </tag>
                <tag name="numobjects" tagType="TSM_INTNUMBER_FORMATTED">
                    <description>
                        <localized_desc language="en">number of files processed</localized_desc>
                    </description>
                    <substitute>__NUMOBJECTS__</substitute>
                </tag>
            </tags>
            <examples>
                <example>
                     <text>31.03.2017 10:53:00 Total number of subfile objects:              0</text>
                     <expectedTags>
                          <expectedTag name="date">2017-03-31 10:53:00</expectedTag>
                          <expectedTag name="numobjects">0</expectedTag>
                     </expectedTags>
                </example>
            </examples>
        </pattern>
        <pattern name="tsm-015">
            <description>
                <localized_desc language="en">summary: number of bytes processed (inspected and transferred)</localized_desc>
            </description>
            <text>__DATE__ Total number of bytes __BYTECATEGORY__:\s+__SIZE__</text>
            <tags>
                <tag name="__date" tagType="TSM_DATETIME">
                    <description>
                        <localized_desc language="en">event date</localized_desc>
                    </description>
                    <substitute>__DATE__</substitute>
                    <callbacks>
                        <callback>dd.MM.YYYY hh:mm:ss</callback>
                    </callbacks>
                </tag>
                <tag name="bytecategory" tagType="TSM_BYTECATEGORY">
                    <description>
                        <localized_desc language="en">category of byte count: inspected or transferred</localized_desc>
                    </description>
                    <substitute>__BYTECATEGORY__</substitute>
                </tag>
                <tag name="size" tagType="TSM_TWODIGITPRECISION_POSTFIXED">
                    <description>
                        <localized_desc language="en">number of bytes processed</localized_desc>
                    </description>
                    <substitute>__SIZE__</substitute>
                </tag>
            </tags>
            <examples>
                <example>
                     <text>31.03.2017 10:53:00 Total number of bytes inspected:         118,89 GB</text>
                     <expectedTags>
                          <expectedTag name="date">2017-03-31 10:53:00</expectedTag>
                          <expectedTag name="bytecategory">inspected</expectedTag>
                          <expectedTag name="size">118,89 GB</expectedTag>
                     </expectedTags>
                </example>
                <example>
                     <text>31.03.2017 10:53:00 Total number of bytes transferred:        16,07 MB</text>
                     <expectedTags>
                          <expectedTag name="date">2017-03-31 10:53:00</expectedTag>
                          <expectedTag name="bytecategory">transferred</expectedTag>
                          <expectedTag name="size">16,07 MB</expectedTag>
                     </expectedTags>
                </example>
            </examples>
        </pattern>
        <pattern name="tsm-016">
            <description>
                <localized_desc language="en">summary: data transfer time</localized_desc>
            </description>
            <text>__DATE__ Data transfer time:\s+__TRANSFERTIME__</text>
            <tags>
                <tag name="__date" tagType="TSM_DATETIME">
                    <description>
                        <localized_desc language="en">event date</localized_desc>
                    </description>
                    <substitute>__DATE__</substitute>
                    <callbacks>
                        <callback>dd.MM.YYYY hh:mm:ss</callback>
                    </callbacks>
                </tag>
                <tag name="size" tagType="TSM_TWODIGITPRECISION_POSTFIXED">
                    <description>
                        <localized_desc language="en">backup transfer duration</localized_desc>
                    </description>
                    <substitute>__TRANSFERTIME__</substitute>
                </tag>
            </tags>
            <examples>
                <example>
                     <text>31.03.2017 10:53:00 Data transfer time:                        4,21 sec</text>
                     <expectedTags>
                          <expectedTag name="date">2017-03-31 10:53:00</expectedTag>
                          <expectedTag name="size">4,21 sec</expectedTag>
                     </expectedTags>
                </example>
            </examples>
        </pattern>
        <pattern name="tsm-017">
            <description>
                <localized_desc language="en">summary: transfer rates</localized_desc>
            </description>
            <text>__DATE__ __TRANSFERCATEGORY__ data transfer rate:\s+__TRANSFERRATE__</text>
            <tags>
                <tag name="__date" tagType="TSM_DATETIME">
                    <description>
                        <localized_desc language="en">event date</localized_desc>
                    </description>
                    <substitute>__DATE__</substitute>
                    <callbacks>
                        <callback>dd.MM.YYYY hh:mm:ss</callback>
                    </callbacks>
                </tag>
                <tag name="transfercategory" tagType="TSM_TRANSFERCATEGORY">
                    <description>
                        <localized_desc language="en">backup transfer category</localized_desc>
                    </description>
                    <substitute>__TRANSFERCATEGORY__</substitute>
                </tag>
                <tag name="size" tagType="TSM_TRANSFERRATE_POSTFIXED">
                    <description>
                        <localized_desc language="en">backup transfer rate</localized_desc>
                    </description>
                    <substitute>__TRANSFERRATE__</substitute>
                </tag>
            </tags>
            <examples>
                <example>
                     <text>31.03.2017 10:53:00 Network data transfer rate:            3.907,43 KB/sec</text>
                     <expectedTags>
                          <expectedTag name="date">2017-03-31 10:53:00</expectedTag>
                          <expectedTag name="transfercategory">Network</expectedTag>
                          <expectedTag name="size">3.907,43 KB/sec</expectedTag>
                     </expectedTags>
                </example>
                <example>
                     <text>31.03.2017 10:53:00 Aggregate data transfer rate:             17,10 KB/sec</text>
                     <expectedTags>
                          <expectedTag name="date">2017-03-31 10:53:00</expectedTag>
                          <expectedTag name="transfercategory">Aggregate</expectedTag>
                          <expectedTag name="size">17,10 KB/sec</expectedTag>
                     </expectedTags>
                </example>
            </examples>
        </pattern>
        <pattern name="tsm-018">
            <description>
                <localized_desc language="en">summary: compression ratio</localized_desc>
            </description>
            <text>__DATE__ Objects compressed by:\s+__COMPRESSRATIO__</text>
            <tags>
                <tag name="__date" tagType="TSM_DATETIME">
                    <description>
                        <localized_desc language="en">event date</localized_desc>
                    </description>
                    <substitute>__DATE__</substitute>
                    <callbacks>
                        <callback>dd.MM.YYYY hh:mm:ss</callback>
                    </callbacks>
                </tag>
                <tag name="compressratio" tagType="TSM_RATIO_PERCENT">
                    <description>
                        <localized_desc language="en">compression ratio</localized_desc>
                    </description>
                    <substitute>__COMPRESSRATIO__</substitute>
                </tag>
            </tags>
            <examples>
                <example>
                     <text>31.03.2017 10:53:00 Objects compressed by:                        0%</text>
                     <expectedTags>
                          <expectedTag name="date">2017-03-31 10:53:00</expectedTag>
                          <expectedTag name="compressratio">0%</expectedTag>
                     </expectedTags>
                </example>
            </examples>
        </pattern>
        <pattern name="tsm-019">
            <description>
                <localized_desc language="en">summary: data reduction ratio</localized_desc>
            </description>
            <text>__DATE__ Total data reduction ratio:\s+__REDUCTIONRATIO__</text>
            <tags>
                <tag name="__date" tagType="TSM_DATETIME">
                    <description>
                        <localized_desc language="en">event date</localized_desc>
                    </description>
                    <substitute>__DATE__</substitute>
                    <callbacks>
                        <callback>dd.MM.YYYY hh:mm:ss</callback>
                    </callbacks>
                </tag>
                <tag name="reductionratio" tagType="TSM_RATIO_PERCENT">
                    <description>
                        <localized_desc language="en">total reduction ratio</localized_desc>
                    </description>
                    <substitute>__REDUCTIONRATIO__</substitute>
                </tag>
            </tags>
            <examples>
                <example>
                     <text>31.03.2017 10:53:00 Total data reduction ratio:               99,99%</text>
                     <expectedTags>
                          <expectedTag name="date">2017-03-31 10:53:00</expectedTag>
                          <expectedTag name="reductionratio">99,99%</expectedTag>
                     </expectedTags>
                </example>
            </examples>
        </pattern>
        <pattern name="tsm-020">
            <description>
                <localized_desc language="en">summary: elapsed processing time</localized_desc>
            </description>
            <text>__DATE__ Elapsed processing time:\s+__PROCESSINGTIME__</text>
            <tags>
                <tag name="__date" tagType="TSM_DATETIME">
                    <description>
                        <localized_desc language="en">event date</localized_desc>
                    </description>
                    <substitute>__DATE__</substitute>
                    <callbacks>
                        <callback>dd.MM.YYYY hh:mm:ss</callback>
                    </callbacks>
                </tag>
                <tag name="processingtime" tagType="TSM_ELAPSED_TIME">
                    <description>
                        <localized_desc language="en">elapsed processing time</localized_desc>
                    </description>
                    <substitute>__PROCESSINGTIME__</substitute>
                </tag>
            </tags>
            <examples>
                <example>
                     <text>31.03.2017 10:53:00 Elapsed processing time:               00:16:02</text>
                     <expectedTags>
                          <expectedTag name="date">2017-03-31 10:53:00</expectedTag>
                          <expectedTag name="processingtime">00:16:02</expectedTag>
                     </expectedTags>
                </example>
            </examples>
        </pattern>
        <pattern name="tsm-021">
            <description>
                <localized_desc language="en">event completed successfully message</localized_desc>
            </description>
            <text>__DATE__ Scheduled event '__SCHEDNAME__' completed successfully</text>
            <tags>
                <tag name="__date" tagType="TSM_DATETIME">
                    <description>
                        <localized_desc language="en">event date</localized_desc>
                    </description>
                    <substitute>__DATE__</substitute>
                    <callbacks>
                        <callback>dd.MM.YYYY hh:mm:ss</callback>
                    </callbacks>
                </tag>
                <tag name="schedule" tagType="TSM_SCHEDULENAME">
                    <description>
                        <localized_desc language="en">name of backup schedule</localized_desc>
                    </description>
                    <substitute>__SCHEDNAME__</substitute>
                </tag>
            </tags>
            <examples>
                <example>
                     <text>31.03.2017 10:53:00 Scheduled event 'DESKTOP_1000_DAILY' completed successfully.</text>
                     <expectedTags>
                          <expectedTag name="date">2017-03-31 10:53:00</expectedTag>
                          <expectedTag name="schedule">DESKTOP_1000_DAILY</expectedTag>
                     </expectedTags>
                </example>
            </examples>
        </pattern>
        <pattern name="tsm-022">
            <description>
                <localized_desc language="en">sending results to server</localized_desc>
            </description>
            <text>__DATE__ Sending results for scheduled event '__SCHEDNAME__'</text>
            <tags>
                <tag name="__date" tagType="TSM_DATETIME">
                    <description>
                        <localized_desc language="en">event date</localized_desc>
                    </description>
                    <substitute>__DATE__</substitute>
                    <callbacks>
                        <callback>dd.MM.YYYY hh:mm:ss</callback>
                    </callbacks>
                </tag>
                <tag name="schedule" tagType="TSM_SCHEDULENAME">
                    <description>
                        <localized_desc language="en">name of backup schedule</localized_desc>
                    </description>
                    <substitute>__SCHEDNAME__</substitute>
                </tag>
            </tags>
            <examples>
                <example>
                     <text>31.03.2017 10:53:00 Sending results for scheduled event 'DESKTOP_1000_DAILY'.</text>
                     <expectedTags>
                          <expectedTag name="date">2017-03-31 10:53:00</expectedTag>
                          <expectedTag name="schedule">DESKTOP_1000_DAILY</expectedTag>
                     </expectedTags>
                </example>
            </examples>
        </pattern>
        <pattern name="tsm-023">
            <description>
                <localized_desc language="en">sent results to server</localized_desc>
            </description>
            <text>__DATE__ Results sent to server for scheduled event '__SCHEDNAME__'</text>
            <tags>
                <tag name="__date" tagType="TSM_DATETIME">
                    <description>
                        <localized_desc language="en">event date</localized_desc>
                    </description>
                    <substitute>__DATE__</substitute>
                    <callbacks>
                        <callback>dd.MM.YYYY hh:mm:ss</callback>
                    </callbacks>
                </tag>
                <tag name="schedule" tagType="TSM_SCHEDULENAME">
                    <description>
                        <localized_desc language="en">name of backup schedule</localized_desc>
                    </description>
                    <substitute>__SCHEDNAME__</substitute>
                </tag>
            </tags>
            <examples>
                <example>
                     <text>31.03.2017 10:53:00 Results sent to server for scheduled event 'DESKTOP_1000_DAILY'.</text>
                     <expectedTags>
                          <expectedTag name="date">2017-03-31 10:53:00</expectedTag>
                          <expectedTag name="schedule">DESKTOP_1000_DAILY</expectedTag>
                     </expectedTags>
                </example>
            </examples>
        </pattern>
        <pattern name="tsm-024">
            <description>
                <localized_desc language="en">summary: subfile reduction ratio</localized_desc>
            </description>
            <text>__DATE__ Subfile objects reduced by:\s+__REDUCTIONRATIO__</text>
            <tags>
                <tag name="__date" tagType="TSM_DATETIME">
                    <description>
                        <localized_desc language="en">event date</localized_desc>
                    </description>
                    <substitute>__DATE__</substitute>
                    <callbacks>
                        <callback>dd.MM.YYYY hh:mm:ss</callback>
                    </callbacks>
                </tag>
                <tag name="reductionratio" tagType="TSM_RATIO_PERCENT">
                    <description>
                        <localized_desc language="en">total reduction ratio</localized_desc>
                    </description>
                    <substitute>__REDUCTIONRATIO__</substitute>
                </tag>
            </tags>
            <examples>
                <example>
                     <text>31.03.2017 10:53:00 Subfile objects reduced by:                   0%</text>
                     <expectedTags>
                          <expectedTag name="date">2017-03-31 10:53:00</expectedTag>
                          <expectedTag name="reductionratio">0%</expectedTag>
                     </expectedTags>
                </example>
            </examples>
        </pattern>
        <pattern name="tsm-025">
            <description>
                <localized_desc language="en">log pruning started</localized_desc>
            </description>
            <text>__DATE__ ANS1483I Schedule log pruning started</text>
            <tags>
                <tag name="__date" tagType="TSM_DATETIME">
                    <description>
                        <localized_desc language="en">event date</localized_desc>
                    </description>
                    <substitute>__DATE__</substitute>
                    <callbacks>
                        <callback>dd.MM.YYYY hh:mm:ss</callback>
                    </callbacks>
                </tag>
            </tags>
            <examples>
                <example>
                     <text>31.03.2017 10:53:00 ANS1483I Schedule log pruning started.</text>
                     <expectedTags>
                          <expectedTag name="date">2017-03-31 10:53:00</expectedTag>
                     </expectedTags>
                </example>
            </examples>
        </pattern>
        <pattern name="tsm-026">
            <description>
                <localized_desc language="en">log prunig finished successfully</localized_desc>
            </description>
            <text>__DATE__ ANS1484I Schedule log pruning finished successfully</text>
            <tags>
                <tag name="__date" tagType="TSM_DATETIME">
                    <description>
                        <localized_desc language="en">event date</localized_desc>
                    </description>
                    <substitute>__DATE__</substitute>
                    <callbacks>
                        <callback>dd.MM.YYYY hh:mm:ss</callback>
                    </callbacks>
                </tag>
            </tags>
            <examples>
                <example>
                     <text>31.03.2017 10:53:00 ANS1484I Schedule log pruning finished successfully.</text>
                     <expectedTags>
                          <expectedTag name="date">2017-03-31 10:53:00</expectedTag>
                     </expectedTags>
                </example>
            </examples>
        </pattern>
    </patterns>
</normalizer>

